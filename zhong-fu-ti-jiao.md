# 重复提交

> 单位时间内,多次非幂等\(post\)请求,造成的后台重复录入现象

此处重点讨论前端的防重复提交的方式

## 前端防重复

### 最终效果

阻止ajax请求

### 一般的思路\(关键技术点\)

* Aborted

xhr的abort函数

* setTimeout

* 限制性操作

修改按钮/UI,弹菊花

...

### 重复判断

> 保存正在进行的ajax操作\(0&lt;readyState&lt;4\)及其url,当该操作存在,且又要发送相同请求时,认为重复提交

### 处理

根据具体情况以及涉及范围,做以下区分

#### ajax拦截\(全局\)

##### 忽略

1. 对于神之iuap的超级接口,需要个性化处理
2. 会无视,结果未返回时,请求参数已变更的请求

快速搭建时使用

#### ajax包裹

##### abort函数

对原有xhr\(ajax\),进行abort处理,类似于timeout,触发条件不一样

对于post,并没有阻止ajax请求,请求已经发送,后台依然在处理请求

对于get,可以保证当前请求为正确的

## 后台重复验证

提前提供id,将创建,改写为"修改",防止一对一的关系转换为一对多

ssh系列的token防重复提交,指的是该系列

缓存系列与数据库平级,不讨论

其他情况并不处理...

