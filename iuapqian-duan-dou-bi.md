用友1年半,每次看到iuap都脱口而出哎呦卧槽,其实1年半时间也不短,鬼知道哎呦卧槽究竟有什么变化,或许有人认为这是欲加之罪,纯属扣屎盆子乱扣的逗比行为,以下为盆子,并且是从我发现到现在依然存在的盆子

为了避免意外,注入兼容性,版本号等智障的问题出现,一下图片均在官网上截取,以github的名义发誓,由本人修改的地方一定会有提示,使用最新chrome,所有问题在3台以上电脑复现过\(卧槽,iuap提个bug还需要报chrome版本号,你倒不如报个能用的版本号\),时间为2017年7月30日01:04:53 前2小时\(我就不信此处描述的盆与部署时间有关\)

# 组件

先说这些屌炸天的组件

## 层叠系列

指modal,下拉,时间,tip等一切层叠相关的组件

先来一个面试题,z-index有哪些特性?请自行度娘或者找个实习生问问

下拉实现如下

![](/assets/iuap-1.png)

很好,将上级容器overflow改为hidden,就会

![](/assets/iuap-2.png)

意料之中,所以当弹出层,grid等需要下拉,tip时

iuap给的具体方案是将上层,上层的上层...overflow修改为auto,很好,滑动显示tip顺带显示滚动条不算bug

easyui,yui看不懂也没事,就算是抄jqueryui也不会出现这种解决方案,难道抄的是bootstrap的dropdowns?人家的定义叫菜单,不叫下拉

下拉\(select\)属于窗口元素,是少数可以穿透浏览器容器的元素,注入

![](/assets/iuap-3.png)

取消这种穿透无所谓,但至少...算了,下拉与菜单的区别,找个实习生问问

当然,如果是山寨的是某些国产山寨的bootstrap系的ui库,记得帮我喷死他

## 迷之定位

![](/assets/iuap-4.png)点击第二下,就迷之上去了

注入多个时间组建下更混乱的方式...官网中没例子就不丢吐了

## 模态框

![](/assets/iuap-5.png)

绑个ko我看看,这段代码为啥又变成jq了,我咋跟小白解释

## 验证

点击提交验证,验证不通过提醒,仅作提醒,点击确定保存,取消继续修改...求实现

长度限制要求到了长度就不允许添加,求实现

当前内容已经错误,字体变红,求实现

通用解决方案丢到ui了...我就不好意思提,我们要求的验证不是这个ui

## 迷之ui

![](/assets/iuap-6.png)

我知道大前神的组内是没有测试的,但我真的不知道,原来大前神都是盲编的,写这个组件的时候,一定是显示器坏了,为了不让业务组的弟兄着急,大前神仅通过键盘和记忆撸了这个组件

![](/assets/iuap-7.png)

这风骚的错落感

![](/assets/iuap-9.png)

美人痣,程序猿中艺术细胞最好的

## ReactUI

![](/assets/iuap-10.png)

专门的吧

时间组件上下跳,需求就是这个,我懂得,假设我是个弹出框下的时间呢?![](/assets/iuap-11.png)

至于具体的api...

卧槽,竟然有人敢用?

## 下拉,不支持datatable

神说,datatable是模型的封装,神说dataSource是下拉的数据源,神却用行动表示,dataSouce必须为数组

联动处理时,需要各种使用dom操作,很好,很MVVM

## datatable不支持嵌套

datatable放屁第一句叫减少错误,为了拓展性,后台会对一个类追加一个属性为对象,一个月内经历了由单层,对,就是datatable希望的那种如`[{name:''}]`类似结构,扩展到五层,我那时一个绝望,就一个将单选变为多选,将属性转换为对象的需求,我需要多写100行,神一样的子孙嵌套结构,抖机灵

## js中写html...

![](/assets/iuap-12.png)

异教徒,这款框架不能加上模板的概念吗,你这么用html,你让小白怎么追加ko绑定\(grid的render系列略\)?

# 概念

再看颠覆传统的概念

## 组件和js组件

先看bootstrap对js组件的定义,`为组件赋予生命`,再看组件文档,即便如dropdown,也会加上此处需要引入js使其动起来,且第一个例子一定无任何交互,即此处定义为

* 组件,亦可叫css组件,无js
* js组件,js对组件赋予生命的结果

iuap中组件的定义包含了js

![](/assets/iuap-13.png)

大哥,你想让我怎么看文档,求教育如何区分iuap下的组建和js组建

## 模型增强

求教育,求指导,model与viewmodel到底有什么养的区别

datatable\(卧槽,ie8,r u sure?\)![](/assets/iuap-14.png)

ko的官网是如下定义

![](/assets/iuap-15.png)

并在例子中,一再明确,通过observable创建vm

神奇的datatable封装以后,嗯...

就变成了model

所以viewmodel的集合+封装==model+增强==datatabel

涨姿势了,我猜,iuap的后台版,一定使用的是mvc两层架构

全组的人都在html中循环,datatable,各种if判断,$parents做关联

很长一段时间我也这样做,因为rows,iuap就是这么提供的,但有一天我回忆起做velocity时,因为业务追加,因为jsp这种蠢萌蠢萌的东西可以写java,模板中嵌套大量业务逻辑时,我才注意到,卧槽,我竟然也在视图/模板里写复杂的业务逻辑了,视图要的是vm啊,model+逻辑转换成视图不行啊

嗯,好像不行,组建不支持非datatable格式

## 控件模型

神一样的控件模型,我就当他是ko组件传参的params,属于调用组件下的参数,但是组建内部是通过jq实现的,会变身的,脱离原有ko的控制了,变身玩的这么好,就是说u-meta 或者 u-type的所有子元素其实全都是配置参数?

# 框架设计

既不是组件,又不是概念的迷之生物

## 迷之命名规范

![](/assets/iuap-16.png)

我就跟`type=textarea`刚上了,这个异教徒为什么不是`u-textarea`

## u-meta

设置组件参数,有以下几种方式

* div占坑+js\(config\)

标准jq组件

* html初始化数据\(自定义属性\)+js初始化

后端渲染方式,html初始化or组件html化均可代表,内部表示数据源,参数表配置,需要处理组件未初始化时样式

* css组件+js事件

轻量级组件,参考bootstrap,最大特点为无法通过样式判断组件是否已经初始化

* u-meta

突破传统结构的初始化方式,表现为

#### u-meta为配置参数的json格式

描述datatable时,一定是string类型

#### 内部结构不可使用ko绑定

组件内部结构是固定好的,请不要乱写,写了也没用

#### 内部结构有必填情况

内部组件是固定好的,但不能不写,比如input组件,如果不写input/textarea,u-meta会很贴心的告诉你,input不存在

\(我当你是slot,但求你自带初始化\)

#### 组件是否初始化可通过ui感知

为了初始化失败导致交互失败,iuap很贴心的通过样式的方式告诉程序猿,你的组件加载失败了

#### Grid组件

datepicker,ztree系列同理

我就请教下,我就一个最简单的grid,却要下载gzip压缩后70K的代码,还不含jq...对,本身还号称不依赖jq,如何处理?

下图实现如何处理?

![](/assets/component-table.png)

不要说这种情况...日,第一版本的时候超级iuap,然后一点一点的煮青蛙,一周一个col的renderType,直到我看的这个进度的UI

每个格子重新用js写html...就算是ko,也有热\(嵌套\)加载/启动的方式,就算不用ko,追加个模板不难吧

就算是和grid组建api一毛一样的Datatable\(表格\)组建,至少人家有plugin的概念

至于其内部的api与datatable间稀奇古怪的关系...还需要暗示吗

# CND

卧槽..就这速度,就这稳定性...CDN,r u sure?

# 性能

肉眼都能看见的卡...需要具体数据吗?

![](/assets/iuap-99.png)

单纯的打开,确定setData可以支持1000条数据吗?

![](/assets/iuap-97.png)点了两下全选,确定setAllRowSelect hold住1000条?

# other

1年半,vue都2了,webpack都3了,node直接8了,我还在跟iuap当年的bug正面刚

求不要删,求不说大规划,求不要道歉,只求怼回来

愿下家没有iuap

